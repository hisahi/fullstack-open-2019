(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{37:function(e,t,n){e.exports=n(74)},72:function(e,t,n){},74:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),u=n(18),c=n.n(u),o=n(3),i=n(20),s=n(12),l=n(8),f=Object(o.b)(function(e){return{style:e.notification.style,message:e.notification.message}},{})(function(e){var t=e.style,n=e.message;return n?a.a.createElement("div",{className:t},n):null}),p=n(1),d=n.n(p),m=n(2),b={style:"",message:""},g=function(e,t,n){return function(){var r=Object(m.a)(d.a.mark(function r(a){return d.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a({type:"NOTIFY",data:{style:e,message:t}}),r.next=3,new Promise(function(e){return setTimeout(e,1e3*n)});case 3:a({type:"HIDE"});case 4:case"end":return r.stop()}},r,this)}));return function(e){return r.apply(this,arguments)}}()},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NOTIFY":return t.data;case"HIDE":return b;default:return e}},v=function(e){var t=Object(r.useState)(""),n=Object(i.a)(t,2),a=n[0],u=n[1];return{type:e,value:a,onChange:function(e){u(e.target.value)},reset:function(){a&&u("")}}},E=n(5),O="http://localhost:3003",w=n(13),y=n.n(w),j={getAll:function(){var e=Object(m.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.get("http://localhost:3003/api/users");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),login:function(){var e=Object(m.a)(d.a.mark(function e(t){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.post("http://localhost:3003/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},x={user:{},notification:{},users:[]},k=function(e,t,n){return function(){var r=Object(m.a)(d.a.mark(function r(a){return d.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:a({type:"BLOG_NOTIFY",data:{tag:e,style:t,message:n}});case 1:case"end":return r.stop()}},r,this)}));return function(e){return r.apply(this,arguments)}}()},B=function(){return function(){var e=Object(m.a)(d.a.mark(function e(t){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.getAll();case 2:n=e.sent,t({type:"INITIALIZE_USERS",data:n});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_USERS":return Object(E.a)({},e,{users:t.data});case"USER_LOGIN":case"USER_READY":return Object(E.a)({},e,{user:t.data});case"USER_LOGOUT":return Object(E.a)({},e,{user:{}});case"CLEAR_NOTIFY":return Object(E.a)({},e,{notification:{}});case"BLOG_NOTIFY":return Object(E.a)({},e,{notification:t.data});default:return e}},N={showNotification:g,clearNotify:function(){return function(){var e=Object(m.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"CLEAR_NOTIFY"});case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},userLogin:function(e){return function(){var t=Object(m.a)(d.a.mark(function t(n){var r;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,j.login(e);case 3:r=t.sent,n({type:"USER_LOGIN",data:r}),t.next=11;break;case 7:return t.prev=7,t.t0=t.catch(0),t.next=11,k("login","error","invalid username or password")(n);case 11:case"end":return t.stop()}},t,this,[[0,7]])}));return function(e){return t.apply(this,arguments)}}()}},I=Object(o.b)(function(e){return{user:e.user.user,notification:e.user.notification}},N)(function(e){var t=v("text"),n=v("password"),r=function(){var r=Object(m.a)(d.a.mark(function r(a){var u;return d.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:a.preventDefault(),u={username:t.value,password:n.value},t.reset(),n.reset(),e.userLogin(u);case 5:case"end":return r.stop()}},r,this)}));return function(e){return r.apply(this,arguments)}}();return"login"===e.notification.tag&&(e.showNotification(e.notification.style,e.notification.message,5),e.clearNotify()),a.a.createElement("div",null,a.a.createElement("h2",null,"Log in to application"),a.a.createElement("form",{onSubmit:r},a.a.createElement("div",null,"username",a.a.createElement("input",Object.assign({name:"Username"},t,{reset:null}))),a.a.createElement("div",null,"password",a.a.createElement("input",Object.assign({name:"Password"},n,{reset:null}))),a.a.createElement("button",{type:"submit"},"log in")))}),T=n(25),A=O+"/api/blogs",_={getAll:function(){var e=Object(m.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.get(A);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),create:function(){var e=Object(m.a)(d.a.mark(function e(t,n){var r,a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={headers:{Authorization:"bearer "+t.token}},e.next=3,y.a.post(A,n,r);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),update:function(){var e=Object(m.a)(d.a.mark(function e(t,n){var r,a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={headers:{Authorization:"bearer "+t.token}},e.next=3,y.a.put("".concat(A,"/").concat(n.id),n,r);case 3:return a=e.sent,console.log(a.data),e.abrupt("return",a.data);case 6:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),remove:function(){var e=Object(m.a)(d.a.mark(function e(t,n){var r,a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={headers:{Authorization:"bearer "+t.token}},e.next=3,y.a.delete("".concat(A,"/").concat(n),r);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},S={blogs:[],notification:{}},U=function(e){return e.sort(function(e,t){return t.likes-e.likes}),e},G=function(){return function(){var e=Object(m.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"CLEAR_NOTIFY"});case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},R=function(e,t,n){return function(){var r=Object(m.a)(d.a.mark(function r(a){return d.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:a({type:"BLOG_NOTIFY",data:{tag:e,style:t,message:n}});case 1:case"end":return r.stop()}},r,this)}));return function(e){return r.apply(this,arguments)}}()},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_BLOGS":var n=Object(T.a)(t.data);return{blogs:U(n),notification:{}};case"NEW_BLOG":var r=t.data,a=[].concat(Object(T.a)(e.blogs),[r]);return{blogs:U(a),notification:{}};case"UPDATE_BLOG":var u=Object(E.a)({},t.data.blog,{user:t.data.user}),c=e.blogs.map(function(e){return e.id!==u.id?e:u});return{blogs:U(c),notification:{}};case"DELETE_BLOG":var o=t.data,i=e.blogs.filter(function(e){return e.id!==o});return{blogs:U(i),notification:{}};case"CLEAR_NOTIFY":return Object(E.a)({},e,{notification:{}});case"BLOG_NOTIFY":return Object(E.a)({},e,{notification:t.data});default:return e}},F={createBlog:function(e,t){return function(){var n=Object(m.a)(d.a.mark(function n(r){var a;return d.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,_.create(e,t);case 3:return a=n.sent,r({type:"NEW_BLOG",data:a}),n.next=7,R("createBlog","success","blog ".concat(a.title," added"))(r);case 7:n.next=13;break;case 9:return n.prev=9,n.t0=n.catch(0),n.next=13,R("createBlog","error","could not add blog")(r);case 13:case"end":return n.stop()}},n,this,[[0,9]])}));return function(e){return n.apply(this,arguments)}}()},clearNotify:G,showNotification:g},D=Object(o.b)(function(e){return{user:e.user.user,notification:e.blogs.notification}},F)(function(e){var t=v("text"),n=v("text"),r=v("url"),u=function(){var a=Object(m.a)(d.a.mark(function a(u){var c;return d.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:u.preventDefault(),c={title:t.value,author:n.value,url:r.value,user:e.user.id},e.createBlog(e.user,c);case 3:case"end":return a.stop()}},a,this)}));return function(e){return a.apply(this,arguments)}}();return"createBlog"===e.notification.tag&&(e.showNotification(e.notification.style,e.notification.message,5),e.clearNotify(),t.reset(),n.reset(),r.reset()),a.a.createElement("div",null,a.a.createElement("form",{onSubmit:u},a.a.createElement("div",null,"title",a.a.createElement("input",Object.assign({required:!0,name:"Title"},t,{reset:null}))),a.a.createElement("div",null,"author",a.a.createElement("input",Object.assign({required:!0,name:"Author"},n,{reset:null}))),a.a.createElement("div",null,"URL",a.a.createElement("input",Object.assign({required:!0,name:"URL"},r,{reset:null}))),a.a.createElement("button",{type:"submit"},"add")))}),Y={likeBlog:function(e,t){return function(){var n=Object(m.a)(d.a.mark(function n(r){var a,u,c,o;return d.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,_.getAll();case 2:return a=n.sent,u=a.find(function(e){return e.id===t}),c=Object(E.a)({},u,{likes:u.likes+1,user:u.user.id}),n.prev=5,n.next=8,_.update(e,c);case 8:return o=n.sent,r({type:"UPDATE_BLOG",data:{blog:o,user:u.user}}),n.next=12,R("likeBlog","success","blog ".concat(u.title," liked"))(r);case 12:n.next=19;break;case 14:return n.prev=14,n.t0=n.catch(5),n.next=18,R("likeBlog","error","could not like blog")(r);case 18:return n.abrupt("return");case 19:case"end":return n.stop()}},n,this,[[5,14]])}));return function(e){return n.apply(this,arguments)}}()},deleteBlog:function(e,t){return function(){var n=Object(m.a)(d.a.mark(function n(r){var a,u;return d.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,_.getAll();case 3:return a=n.sent,u=a.find(function(e){return e.id===t}),n.next=7,_.remove(e,t);case 7:R("deleteBlog","success","blog ".concat(u.title," deleted")),n.next=14;break;case 10:return n.prev=10,n.t0=n.catch(0),R("deleteBlog","error","could not delete blog"),n.abrupt("return");case 14:r({type:"DELETE_BLOG",data:t});case 15:case"end":return n.stop()}},n,this,[[0,10]])}));return function(e){return n.apply(this,arguments)}}()},addCommentToBlog:function(e,t,n){return function(){var r=Object(m.a)(d.a.mark(function r(a){var u,c,o,i;return d.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,_.getAll();case 2:return u=r.sent,c=u.find(function(e){return e.id===t}),o=Object(E.a)({},c,{comments:c.comments.concat(n),user:c.user.id}),r.prev=5,r.next=8,_.update(e,o);case 8:return i=r.sent,a({type:"UPDATE_BLOG",data:{blog:i,user:c.user}}),r.next=12,R("addCommentToBlog","success","comment added")(a);case 12:r.next=19;break;case 14:return r.prev=14,r.t0=r.catch(5),r.next=18,R("addCommentToBlog","error","could not add comment")(a);case 18:return r.abrupt("return");case 19:case"end":return r.stop()}},r,this,[[5,14]])}));return function(e){return r.apply(this,arguments)}}()}},z=Object(o.b)(function(e){return{user:e.user.user}},Y)(function(e){var t=e.blog,n=function(){var t=Object(m.a)(d.a.mark(function t(n,r){return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.stopPropagation(),e.likeBlog(e.user,r.id);case 2:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),r=function(){var t=Object(m.a)(d.a.mark(function t(n,r){return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.stopPropagation(),window.confirm("Do you want to delete the blog ".concat(r.title,"?"))&&e.deleteBlog(e.user,r.id);case 2:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),u=function(){var t=Object(m.a)(d.a.mark(function t(n,r){var a;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault(),(a=n.target.text.value)&&e.addCommentToBlog(e.user,r.id,a);case 3:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),c={paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5};return e.showFull?a.a.createElement("div",{style:c},a.a.createElement("div",null,a.a.createElement("p",null,t.title," by ",t.author),a.a.createElement("p",null,a.a.createElement("a",{href:t.url},t.url)),a.a.createElement("p",null,t.likes," likes ",a.a.createElement("button",{type:"button",onClick:function(e){return n(e,t)}},"like")),a.a.createElement("p",null,"added by ",t.user.name),null!==e.user&&t.user.username===e.user.username&&a.a.createElement("p",null,a.a.createElement("button",{type:"button",onClick:function(e){return r(e,t)}},"delete")),a.a.createElement("h3",null,"comments"),a.a.createElement("form",{onSubmit:function(e){return u(e,t)}},a.a.createElement("input",{name:"text",required:!0}),a.a.createElement("input",{type:"submit",value:"comment"})),a.a.createElement("ul",null,t.comments.map(function(e,t){return a.a.createElement("li",{key:t},e)})))):a.a.createElement("div",{style:c},a.a.createElement("div",null,a.a.createElement(s.b,{to:"/blogs/".concat(t.id)},t.title)," by ",t.author))}),P={showNotification:g,clearNotify:G},q=Object(o.b)(function(e){return{blogs:e.blogs.blogs,notification:e.blogs.notification}},P)(function(e){return"likeBlog"!==e.notification.tag&&"deleteBlog"!==e.notification.tag&&"addCommentToBlog"!==e.notification.tag||(e.showNotification(e.notification.style,e.notification.message,5),e.clearNotify()),a.a.createElement("div",null,e.blogs.map(function(e){return a.a.createElement(z,{key:e.id,blog:e})}))}),J={initializeUsers:B},W=Object(o.b)(function(e){return{user:e.user.user,users:e.user.users,blogs:e.blogs.blogs}},J)(function(e){return Object(r.useEffect)(function(){e.initializeUsers()},[]),a.a.createElement("table",null,a.a.createElement("thead",null,a.a.createElement("td",null,"User"),a.a.createElement("td",null,"Blogs")),a.a.createElement("tbody",null,e.users.map(function(t){return a.a.createElement("tr",{key:t.id},a.a.createElement("td",null,a.a.createElement(s.b,{to:"/users/".concat(t.id)},t.name)),a.a.createElement("td",null,e.blogs.filter(function(e){return t.id===e.user.id}).length))})))}),Z={showNotification:g,clearNotify:G},H=Object(o.b)(function(e,t){return{self:e.user.user,blog:e.blogs.blogs.find(function(e){return e.id===t.id}),notification:e.blogs.notification}},Z)(function(e){return e.blog?("likeBlog"!==e.notification.tag&&"deleteBlog"!==e.notification.tag&&"addCommentToBlog"!==e.notification.tag||(e.showNotification(e.notification.style,e.notification.message,5),e.clearNotify()),a.a.createElement("div",null,a.a.createElement(z,{key:e.blog.id,blog:e.blog,showFull:!0}))):null}),M={initializeUsers:B},K=Object(o.b)(function(e,t){return{self:e.user.user,user:e.user.users.find(function(e){return e.id===t.id}),blogs:e.blogs.blogs}},M)(function(e){return Object(r.useEffect)(function(){e.initializeUsers()},[]),e.user?a.a.createElement("div",null,a.a.createElement("h1",null,e.user.name),a.a.createElement("h2",null,"added blogs"),a.a.createElement("ul",null,e.blogs.filter(function(t){return e.user.id===t.user.id}).map(function(e){return a.a.createElement("li",{key:e.id},a.a.createElement(s.b,{to:"/blogs/".concat(e.id)},e.title))}))):null}),Q={initializeBlogs:function(){return function(){var e=Object(m.a)(d.a.mark(function e(t){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.getAll();case 2:n=e.sent,t({type:"INITIALIZE_BLOGS",data:n});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},userLoginAuto:function(e){return function(){var t=Object(m.a)(d.a.mark(function t(n){return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"USER_READY",data:e});case 1:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},userLogout:function(){return function(){var e=Object(m.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"USER_LOGOUT"});case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}},V=Object(o.b)(function(e){return{user:e.user.user}},Q)(function(e){var t=Object(r.useState)(!1),n=Object(i.a)(t,2),u=n[0],c=n[1];Object(r.useEffect)(function(){e.user.token&&window.localStorage.setItem("loggedBlogAppUser",JSON.stringify(e.user))}),Object(r.useEffect)(function(){e.initializeBlogs()},[]),Object(r.useEffect)(function(){var t=window.localStorage.getItem("loggedBlogAppUser");t&&e.userLoginAuto(JSON.parse(t))},[]);var o={padding:5};return a.a.createElement("div",null,a.a.createElement(s.a,null,a.a.createElement("div",null,a.a.createElement(f,null),e.user.token?a.a.createElement(a.a.Fragment,null,a.a.createElement("div",null,a.a.createElement(s.b,{style:o,to:"/"},"blogs"),a.a.createElement(s.b,{style:o,to:"/users"},"users"),e.user.name," (",e.user.username,") logged in.",a.a.createElement("button",{type:"button",onClick:function(){window.localStorage.clear(),e.userLogout()}},"log out")),a.a.createElement(l.a,{exact:!0,path:"/",render:function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",null,a.a.createElement("h2",null,"new blog"),a.a.createElement(D,null),a.a.createElement("h2",null,"blogs"),a.a.createElement(q,null)))}}),a.a.createElement(l.a,{exact:!0,path:"/users",render:function(){return a.a.createElement(W,null)}}),a.a.createElement(l.a,{exact:!0,path:"/users/:id",render:function(e){var t=e.match;return a.a.createElement(K,{id:t.params.id})}}),a.a.createElement(l.a,{exact:!0,path:"/blogs/:id",render:function(e){var t=e.match;return a.a.createElement(H,{id:t.params.id})}})):a.a.createElement("div",null,!u&&a.a.createElement("button",{onClick:function(){return c(!0)}},"log in"),u&&a.a.createElement(a.a.Fragment,null,a.a.createElement(I,null),a.a.createElement("button",{onClick:function(){return c(!1)}},"cancel"))))))}),X=n(14),$=n(35),ee=n(36),te=Object(X.combineReducers)({blogs:C,notification:h,user:L}),ne=Object(X.createStore)(te,Object(ee.composeWithDevTools)(Object(X.applyMiddleware)($.a)));n(72);c.a.render(a.a.createElement(o.a,{store:ne},a.a.createElement(V,null)),document.getElementById("root"))}},[[37,2,1]]]);
//# sourceMappingURL=main.d02cd6f9.chunk.js.map